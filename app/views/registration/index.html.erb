<body>
    <div class="form-container">
        <p style="color:#545454"><a href="/login" style="color : red; ">  &#60; Back  </a></p>

        <h1>Register Form</h1>
            <% if flash[:success] %>
            <div class="alert alert-success"><%= flash[:success] %></div>
        <% end %>

        <turbo-frame id="error-messages">
        </turbo-frame>
        
        <%= form_with(model: @user_info, url: registration_path, method: :post, remote: true) do |form| %>

        <div class="form-group">
            <%= form.label :FirstName, "First Name" %>
            <%= form.text_field :FirstName, name: 'user_info[FirstName]', required: true, maxlength: 30, placeholder: "ex. netdy" %>
        </div>

        <div class="form-group">
            <%= form.label :LastName, "Last Name" %>
            <%= form.text_field :LastName, name: 'user_info[LastName]', required: true, maxlength: 30, placeholder: "ex. pallypysix"%>
        </div>

        <div class="form-group birthday-group">
            <%= form.label :DateOfBirth, "Date of Birth" %>
            <div class="birthday-inputs">
                <%= form.select :birth_day, (1..31).map { |d| [d, d] }, { prompt: 'Date' }, { class: 'form-select' } %>
                <%= form.select :birth_month, Date::MONTHNAMES.compact.each_with_index.map { |name, i| [name, i+1] }, { prompt: 'Month' }, { class: 'form-select' } %>
                <%= form.select :birth_year, ((Date.today.year - 100 + 543)..(Date.today.year + 543)).to_a.reverse, { prompt: 'Year' }, { class: 'form-select' } %>
            </div>
            <%= form.hidden_field :DateOfBirth %>
        </div>

        <div class="form-group gender">
            <%= form.label :Gender, "Gender" %>
            <div class="radio-group">
                <%= form.radio_button :Gender, 'Male', name: 'user_info[Gender]', required: true %>
                <%= form.label :GenderMale, 'Male' %>
                <%= form.radio_button :Gender, 'Female', name: 'user_info[Gender]', required: true %>
                <%= form.label :GenderFemale, 'Female'%>
            </div>  
        </div>

        <div class="form-group">
            <%= form.label :Email %>
            <%= form.email_field :Email, name: 'user_info[Email]', required: true , placeholder: "ex. example@hello.com"%>
        </div>

        <div class="form-group">
            <%= form.label :PhoneNumber, "Phone Number" %>
            <%= form.telephone_field :PhoneNumber, name: 'user_info[PhoneNumber]', required: true, placeholder: "ex. 0987654321",
                                     pattern: '0\d{9}', title: 'Phone number must be 10 digits and start with 0' %>
        </div>

        <div class="form-group full-width">
            <%= form.label :Subject, "Subject" %>
            <%= form.select :Subject, 
                            ['Front-end', 'Back-end', 'Database'],
                            { prompt: 'Choose option' },
                            { name: 'user_info[Subject]', required: true } %>
        </div>

        <div class="form-group full-width">
            <%= form.submit "Submit" %>
        </div>
        <p style="color:#545454">If you have an account, <a href="/login" style="color : red; "> login here. </a></p>

    <% end %>    
    </div>
</body>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const daySelect = document.querySelector('select[name="user_info[birth_day]"]');
  const monthSelect = document.querySelector('select[name="user_info[birth_month]"]');
  const yearSelect = document.querySelector('select[name="user_info[birth_year]"]');
  const dateOfBirthInput = document.querySelector('input[name="user_info[DateOfBirth]"]');

  function updateDateOfBirth() {
    const day = daySelect.value.padStart(2, '0');
    const month = monthSelect.value.padStart(2, '0');
    const year = parseInt(yearSelect.value) - 543; // แปลง พ.ศ. เป็น ค.ศ.
    if (day && month && year) {
      dateOfBirthInput.value = `${year}-${month}-${day}`;
    }
  }

  daySelect.addEventListener('change', updateDateOfBirth);
  monthSelect.addEventListener('change', updateDateOfBirth);
  yearSelect.addEventListener('change', updateDateOfBirth);
});
</script>


